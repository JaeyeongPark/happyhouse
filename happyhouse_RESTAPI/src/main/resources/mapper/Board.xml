<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.dao.BoardDAO">

	<insert id="insertboard" parameterType="BoardDTO">
		insert into board (id, subject, contents) values (#{id},#{subject},#{contents})
	</insert>

	<update id="updateboard" parameterType="BoardDTO">
		update board 
		set subject = #{subject}, contents = #{contents} 
		where no = #{no}
	</update>
	
	<delete id="deleteboard" parameterType="BoardDTO">
		delete from board where no = #{no}
	</delete>
	
	<select id="listboard" resultType="BoardDTO" parameterType="map">
		select no, id, subject, contents, search
		from board
		<if test='listParameterDTO.word != null'>
			<if test='listParameterDTO.key.equals("id")'>
			where id = #{listParameterDTO.word}
			</if>
			<if test='listParameterDTO.key.equals("subject")'>
			where subject like concat('%', #{listParameterDTO.word}, '%')
			</if>
			<if test='listParameterDTO.key.equals("contents")'>
			where contents like concat('%', #{listParameterDTO.word}, '%')
			</if>
		</if>
		limit #{listParameterDTO.start},#{listParameterDTO.currentPerPage}
	</select>
	
	<select id="listondeboard" resultType="BoardDTO" parameterType="string">
		select no, id, subject, contents, search 
		from board
		where no = #{no}
	</select>
	
	<select id="getTotalCount" resultType="int" parameterType="map">
		select count(no)
		from board
		<if test='listParameterDTO.word != null'>
			<if test='listParameterDTO.key.equals("id")'>
			where id = #{listParameterDTO.word}
			</if>
			<if test='listParameterDTO.key.equals("subject")'>
			where subject like concat('%', #{listParameterDTO.word}, '%')
			</if>
			<if test='listParameterDTO.key.equals("contents")'>
			where contents like concat('%', #{listParameterDTO.word}, '%')
			</if>
		</if>
	</select>
		
	<update id="countsearch" parameterType="string">
        update board 
        set search = search+1
        where no = #{no}
    </update>

	<select id="listwholeboard" resultType="BoardDTO">
        select no, id, subject, contents, search 
        from board
    </select>
</mapper>

